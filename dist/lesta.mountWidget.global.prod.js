(()=>{var I=Object.defineProperty;var z=(o,t)=>{for(var e in t)I(o,e,{get:t[e],enumerable:!0})};function f(o){return o?typeof o=="object"?JSON.parse(JSON.stringify(o)):o:o??null}function v(o){function t(a){let p=document.createElement("capsule");return p.innerHTML=a,p}function e(a){let p=a.querySelectorAll("script");for(let c of p)c.remove()}function s(a,p){let c=p.replace(/\s+/g,"").toLowerCase();if(["src","href","xlink:href"].includes(a)&&(c.includes("javascript:")||c.includes("data:text/html"))||a.startsWith("on"))return!0}function r(a){let p=a.attributes;for(let{name:c,value:m}of p)s(c,m)&&a.removeAttribute(c)}function n(a){let p=a.children;for(let c of p)r(c),n(c)}let i=t(o);return e(i),n(i),i.childNodes}var h=(o="root",t,e="")=>{};var b=class{constructor(t,e,s){this.component=t,this.app=e,this.proxiesData={},this.context={app:e,phase:0,abortSignal:s,options:t,container:null,node:{},param:{},method:{},proxy:{},source:t.sources||{}}}async loaded(t){if(this.component.loaded)return await this.component.loaded.bind(this.context)(t)}async rendered(){if(typeof this.component!="object")return h(this.context.container.nodepath,211);if(this.component.rendered)return await this.component.rendered.bind(this.context)()}async created(){if(this.component.created)return await this.component.created.bind(this.context)()}methods(){if(this.component.methods)for(let[t,e]of Object.entries(this.component.methods))this.context.method[t]=e.bind(this.context);Object.preventExtensions(this.context.method)}params(){if(this.component.params){for(let t in this.component.params)if(t in this.context.param)return h(this.context.container.nodepath,213,t);Object.assign(this.context.param,f(this.component.params))}Object.preventExtensions(this.context.param)}proxies(){if(this.component.proxies)for(let t in this.component.proxies){if(t in this.proxiesData)return h(this.context.container.nodepath,214,t);this.proxiesData[t]=this.component.proxies[t]}this.context.proxy=this.getProxy(),Object.preventExtensions(this.context.proxy)}};function d(o,t,e=""){if(!(o&&(o.constructor.name==="Object"||o.constructor.name==="Array")))return o;let s={getPrototypeOf(r){return{target:r,instance:"Proxy"}},get(r,n,i){return typeof n=="symbol"||t.get?.(r,n,`${e}${n}`),Reflect.get(r,n,i)},set(r,n,i,a){if(typeof n=="symbol")return Reflect.set(r,n,i,a);let p=!1;return t.beforeSet(i,`${e}${n}`,m=>{i=m,p=!0})||!(Reflect.get(r,n,a)!==i||n==="length"||p)||(i=d(i,t,`${e}${n}.`),Reflect.set(r,n,i,a),t.set(r,i,`${e}${n}`)),!0},deleteProperty(r,n){return Reflect.deleteProperty(r,n)},defineProperty(r,n,i){return Reflect.defineProperty(r,n,i)}};o=f(o);for(let r in o)o[r]=d(o[r],t,`${e}${r}.`);return new Proxy(o,s)}function x(o,t,e){if(!o)return;let s=(r,n)=>{let i=Math.min(r.length,n.length);return r.slice(0,i)===n.slice(0,i)};for(let[r,n]of o)Array.isArray(n)?n.includes(t)&&r(e):s(t,n)&&r(e,t.length>n.length?t.replace(n+".",""):void 0)}var L={};z(L,{_attr:()=>q,_class:()=>S,_evalHTML:()=>R,_event:()=>H,_html:()=>M,_text:()=>T});var M={update:(o,t)=>{o.innerHTML="",t&&o.append(...v(t))}};var R={update:(o,t)=>t!==void 0?o.innerHTML=t:""};var S={update:(o,t,e)=>t?o.classList.add(e):o.classList.remove(e)};var T={update:(o,t)=>{t!==void 0&&(o.textContent=t!==Object(t)?t:JSON.stringify(t))}};var q={update:(o,t,e)=>{typeof t=="boolean"?t?o.setAttribute(e,""):o.removeAttribute(e):o.setAttribute(e,t)}};var H={create:(o,t)=>{for(let e in t)o.addEventListener(e,t[e])},destroy:(o,t)=>{for(let e in t)o.removeEventListener(e,t[e])}};var u=(o,t,e="")=>{};var V={refs:[],collect:!1,define(o){return o&&this.refs.every(t=>t.startsWith(this.refs.at(0)))?this.refs.at(-1):[...this.refs]},clear(){this.collect=!1,this.refs.length=0}};var w=class extends b{constructor(t,e,s,r){super(t,e,s),this.Nodes=r,this.impress=V,this.context={...this.context,directives:{...L,...e.directives,...t.directives}}}async props(){}async mounted(){this.component.mounted&&await this.component.mounted.bind(this.context)()}getProxy(){return d(this.proxiesData,{beforeSet:(t,e,s)=>{if(this.component.setters?.[e]){let r=this.component.setters[e].bind(this.context)(t);if(r===void 0)return!0;s(r)}},set:(t,e,s)=>{for(let r in this.context.node){let n=this.context.node[r];x(n.reactivity.node,s),x(n.reactivity.component,s,e);for(let i in n.section)x(n.section[i]?.reactivity.component,s,e)}this.component.handlers?.[s]?.bind(this.context)(e)},get:(t,e,s)=>{this.impress.collect&&!this.impress.refs.includes(s)&&typeof t[e]!="function"&&this.impress.refs.push(s)}})}async nodes(){if(this.component.nodes){let t=this.component.nodes.bind(this.context)(),e=this.context.container;for await(let[s,r]of Object.entries(t)){let n=r.selector||this.context.selector||`.${s}`,i=typeof n=="function"?n(s):n,a=e.querySelector(i)||e.classList.contains(s)&&e,p=e.nodepath?e.nodepath+"."+s:s;if(a){if(a.nodepath=p,a.nodename=s,Object.assign(this.context.node,{[s]:a}),r){let c=new this.Nodes(r,this.context,a,this.impress,this.app,s);for await(let[m]of Object.entries(r))await c.controller(m)}}else u(p,105)}Object.preventExtensions(this.context.node)}}};var l=class{constructor(t,e,s,r,n,i){this.app=n,this.node=t,this.context=e,this.impress=r,this.nodeElement=s,this.keyNode=i,this.nodeElement.reactivity={node:new Map}}reactive(t,e,s){return t?.length&&s.set(e,t),this.impress.clear(),t}reactiveNode(t,e){this.reactive(t,e,this.nodeElement.reactivity.node)}};var E=class extends l{constructor(...t){super(...t)}init(t){let e=this.nodeElement;if(!t.startsWith("_"))return u(e.nodepath,102,t);let s=this.context.directives[t],r=this.node[t],{create:n,update:i,destroy:a}=s;e.hasOwnProperty("directives")||Object.assign(e,{directives:{}}),Object.assign(e.directives,{[t]:{create:()=>n?n.bind(s)(e,r):{},destroy:()=>a?a.bind(s)(e,r):{}}}),n&&e.directives[t].create();let p=(c,m,W)=>{let O=U=>i.bind(s)(e,U,m,W);typeof c=="function"?(this.impress.collect=!0,O(c(e)),this.reactiveNode(this.impress.define(),()=>O(c(e)))):O(c)};if(i)if(typeof r=="object")for(let c in r)p(r[c],c,r);else p(r)}};var g=class extends l{constructor(...t){super(...t)}listeners(t){typeof this.node[t]=="function"&&(this.nodeElement[t]=e=>this.node[t].bind(this.context)(e,this.nodeElement))}general(t){if(t==="innerHTML")return u(this.nodeElement.nodepath,106);if(typeof this.node[t]=="function"){let e=()=>{let s=this.node[t].bind(this.context)(this.nodeElement);this.nodeElement[t]!==null&&typeof this.nodeElement[t]=="object"?s!==null&&typeof s=="object"?Object.assign(this.nodeElement[t],s):u(this.nodeElement.nodepath,103,t):this.nodeElement[t]=s};this.impress.collect=!0,e(),this.reactiveNode(this.impress.define(),e)}else this.nodeElement[t]=this.node[t]}init(t){t.startsWith("on")?this.listeners(t):this.general(t)}};var y=class{constructor(t,e,s,r,n,i){this.app=n,this.node=t,this.context=e,this.impress=r,this.nodeElement=s,this.keyNode=i,this.native=new g(t,e,s,r,n,i),this.directive=new E(t,e,s,r,n,i)}async controller(t){t in this.nodeElement?this.native.init(t):t in this.context.directives?this.directive.init(t):t==="component"&&this.component?await this.component():t!=="selector"&&u(this.nodeElement.nodepath,104,t)}};async function C(o,t,e){let s=[async()=>await o.loaded(),async()=>{if(o.context.container=t(),typeof document<"u")return await o.rendered()},async()=>(await o.props(),o.params(),o.methods(),o.proxies(),await o.created()),async()=>{if(await o.nodes(),typeof document<"u")return await o.mounted()}];for await(let r of s){let n=await r();if(o.context.phase++,o.context.abortSignal?.aborted||n){e&&e({phase:o.context.phase,data:n,abortSignal:o.context.abortSignal});return}}return o.context.container}async function N(o,t,e,s){if(!o)return h("root",216);e&&!(e instanceof AbortSignal)&&h("root",217),s&&typeof s!="function"&&h("root",218);let r=new w(o,{},e,y);return await C(r,()=>{t.innerHTML=o.template,r.context.container=t},s),{destroy(){delete t.reactivity,delete t.method,t.innerHTML=""}}}window.lesta={mountWidget:N};})();
